<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PBMC10K tutorial for COSG â€¢ COSG</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PBMC10K tutorial for COSG">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">COSG</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/quick_start.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pbmc10k_tutorial_cosg.html">PBMC 10K guided tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/genecell/COSGR">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>PBMC10K tutorial for COSG</h1>
                        <h4 class="author">Min Dai</h4>
            
            <h4 class="date">2021/6/18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/genecell/COSGR/blob/master/vignettes/pbmc10k_tutorial_cosg.Rmd"><code>vignettes/pbmc10k_tutorial_cosg.Rmd</code></a></small>
      <div class="hidden name"><code>pbmc10k_tutorial_cosg.Rmd</code></div>

    </div>

    
    
<div id="load-the-library" class="section level3">
<h3 class="hasAnchor">
<a href="#load-the-library" class="anchor"></a>Load the library</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COSG) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span></code></pre></div>
</div>
<div id="load-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-the-data" class="anchor"></a>Load the data</h3>
<p>Download data from 10x Genomics:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># getwd()</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"https://cf.10xgenomics.com/samples/cell-exp/3.0.0/pbmc_10k_protein_v3/pbmc_10k_protein_v3_filtered_feature_bc_matrix.h5"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile =</span> <span class="st">"./pbmc_10k_protein_v3_filtered_feature_bc_matrix.h5"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please install hdf5r to read HDF5 files</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pbmc10k_raw<span class="ot">&lt;-</span><span class="fu">Read10X_h5</span>(<span class="st">'./pbmc_10k_protein_v3_filtered_feature_bc_matrix.h5'</span>)</span></code></pre></div>
<pre><code>## Genome matrix has multiple modalities, returning a list of matrices for this genome</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pbmc10k<span class="ot">&lt;-</span><span class="fu">CreateSeuratObject</span>(pbmc10k_raw<span class="sc">$</span><span class="st">`</span><span class="at">Gene Expression</span><span class="st">`</span>,<span class="at">assay =</span> <span class="st">'RNA'</span>,<span class="at">project =</span> <span class="st">'COSG'</span>,  <span class="at">min.cells =</span> <span class="dv">5</span>, <span class="at">min.features =</span> <span class="dv">200</span>) </span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pbmc10k</span></code></pre></div>
<pre><code>## An object of class Seurat 
## 16845 features across 7856 samples within 1 assay 
## Active assay: RNA (16845 features, 0 variable features)</code></pre>
</div>
<div id="quality-control" class="section level3">
<h3 class="hasAnchor">
<a href="#quality-control" class="anchor"></a>Quality control</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pbmc10k[[<span class="st">"percent.mt"</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(pbmc10k, <span class="at">pattern =</span> <span class="st">"^MT-"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize QC metrics as a violin plot</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(pbmc10k, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>, <span class="st">"nCount_RNA"</span>, <span class="st">"percent.mt"</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="pbmc10k_tutorial_cosg_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">FeatureScatter</span>(pbmc10k, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"percent.mt"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">FeatureScatter</span>(pbmc10k, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"nFeature_RNA"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span></code></pre></div>
<p><img src="pbmc10k_tutorial_cosg_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pbmc10k <span class="ot">&lt;-</span> <span class="fu">subset</span>(pbmc10k, <span class="at">subset =</span> nFeature_RNA <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> nFeature_RNA <span class="sc">&lt;</span> <span class="dv">2500</span> <span class="sc">&amp;</span> nCount_RNA <span class="sc">&lt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> nCount_RNA <span class="sc">&gt;</span> <span class="dv">500</span> <span class="sc">&amp;</span> percent.mt <span class="sc">&lt;</span> <span class="dv">5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pbmc10k</span></code></pre></div>
<pre><code>## An object of class Seurat 
## 16845 features across 2080 samples within 1 assay 
## Active assay: RNA (16845 features, 0 variable features)</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">FeatureScatter</span>(pbmc10k, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"percent.mt"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">FeatureScatter</span>(pbmc10k, <span class="at">feature1 =</span> <span class="st">"nCount_RNA"</span>, <span class="at">feature2 =</span> <span class="st">"nFeature_RNA"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span></code></pre></div>
<p><img src="pbmc10k_tutorial_cosg_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="normalization" class="section level3">
<h3 class="hasAnchor">
<a href="#normalization" class="anchor"></a>Normalization</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pbmc10k <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(pbmc10k, <span class="at">normalization.method =</span> <span class="st">"LogNormalize"</span>, <span class="at">scale.factor =</span> <span class="dv">10000</span>)</span></code></pre></div>
</div>
<div id="feature-selection" class="section level3">
<h3 class="hasAnchor">
<a href="#feature-selection" class="anchor"></a>Feature selection</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pbmc10k <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(pbmc10k, <span class="at">selection.method =</span> <span class="st">"vst"</span>, <span class="at">nfeatures =</span> <span class="dv">2000</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the 10 most highly variable genes</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">VariableFeatures</span>(pbmc10k), <span class="dv">10</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot variable features with and without labels</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">VariableFeaturePlot</span>(pbmc10k)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">LabelPoints</span>(<span class="at">plot =</span> plot1, <span class="at">points =</span> top10, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## When using repel, set xnudge and ynudge to 0 for optimal results</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plot2</span></code></pre></div>
<p><img src="pbmc10k_tutorial_cosg_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="run-pca" class="section level3">
<h3 class="hasAnchor">
<a href="#run-pca" class="anchor"></a>Run PCA</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pbmc10k <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(pbmc10k, <span class="at">features =</span> <span class="fu">rownames</span>(pbmc10k))</span></code></pre></div>
<pre><code>## Centering and scaling data matrix</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pbmc10k <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(pbmc10k, <span class="at">features =</span> <span class="fu">VariableFeatures</span>(<span class="at">object =</span> pbmc10k))</span></code></pre></div>
<pre><code>## PC_ 1 
## Positive:  EEF1A1, RPS12, TRAC, RPS18, TRBC2, IL32, IL7R, LTB, NOSIP, LEF1 
##     CD7, CD69, CD27, ITM2A, TRBC1, CD247, CCR7, CD2, GZMM, MAL 
##     TRABD2A, TRAT1, FLT3LG, CD40LG, AQP3, TNFRSF25, APBA2, CD5, RORA, CHRM3-AS2 
## Negative:  FCN1, LYZ, MNDA, S100A8, S100A9, CD14, CSTA, CST3, SERPINA1, VCAN 
##     S100A12, SPI1, CYBB, CFD, MPEG1, CEBPD, CLEC7A, CD68, GRN, CSF3R 
##     MS4A6A, CLEC12A, KLF4, RGS2, FPR1, TYMP, CD36, AC020656.1, C5AR1, KCTD12 
## PC_ 2 
## Positive:  NKG7, CST7, GZMA, GZMH, KLRD1, PRF1, CCL5, FGFBP2, GNLY, CTSW 
##     GZMB, FCGR3A, KLRF1, SPON2, B2M, HOPX, EFHD2, CCL4, TRDC, MATK 
##     CMC1, PRSS23, TTC38, C12orf75, CD63, TBX21, HCST, MYO1F, FCRL6, APMAP 
## Negative:  TPT1, RPS12, RPS18, EEF1A1, LTB, RPLP1, IL7R, LEF1, NOSIP, CCR7 
##     TRAC, CD27, MAL, TRABD2A, CD40LG, IL6ST, JUNB, ZFP36L2, SERINC5, MYC 
##     TRAT1, SATB1, BEX3, CD55, NCF1, ARMH1, AIF1, CHRM3-AS2, SOCS3, TNFRSF25 
## PC_ 3 
## Positive:  IGHM, MS4A1, CD79A, BCL11A, FAM129C, SPIB, IGHD, BANK1, TCL1A, TSPAN13 
##     LINC00926, HLA-DQA1, HLA-DQB1, FCER2, IRF8, MEF2C, TCF4, VPREB3, HLA-DRA, HLA-DQA2 
##     CD79B, BLNK, HLA-DPB1, HLA-DRB5, COBLL1, IGKC, CD74, CD22, HLA-DPA1, TNFRSF13C 
## Negative:  TRAC, IL7R, IL32, JUNB, NOSIP, TMSB4X, LEF1, CD7, HCST, ANXA1 
##     TPT1, S100A4, S100A6, ITGB2, S100A10, TRBC1, CD27, CD247, NEAT1, CD2 
##     MAL, TRAT1, ITM2A, SLC2A3, FOS, S100A12, ACTG1, SERINC5, VSIR, S100A9 
## PC_ 4 
## Positive:  SERPINF1, LILRA4, IL3RA, GAS6, PLD4, LRRC26, RHEX, CLEC4C, SCT, PTCRA 
##     PACSIN1, SMPD3, LAMP5, IRF4, DNASE1L3, DERL3, ITM2C, SCAMP5, ZNF888, FCER1A 
##     MAP1A, SMIM5, CIB2, TCF4, CCDC50, TPM2, SCN9A, TNFRSF21, AC004846.1, UGCG 
## Negative:  MS4A1, CD79A, IGHD, LINC00926, FCER2, BANK1, VPREB3, CD22, TNFRSF13C, HLA-DOB 
##     ADAM28, FCRL1, P2RX5, FCRLA, IGLC2, CD79B, CD19, CD24, CD72, IGHM 
##     IGLC3, PLPP5, LINC02397, HLA-DQA1, CD40, HLA-DQB1, RALGPS2, EAF2, FCRL2, BLK 
## PC_ 5 
## Positive:  CD9, PRKAR2B, HIST1H2AC, MAP3K7CL, CAVIN2, GNG11, NRGN, PF4, C19orf33, ACRBP 
##     CMTM5, MPP1, CTTN, TMEM40, PPBP, TUBB1, F13A1, CLU, TSC22D1, RGS18 
##     PARVB, MYL9, DMTN, TST, SPARC, MTURN, TREML1, AP003068.2, THBS1, GP9 
## Negative:  EEF1A1, TPT1, RPS18, RPLP1, RPS12, PLAC8, CYBA, ZFP36L2, SERPINF1, HCST 
##     LILRA4, TYROBP, PLD4, GZMB, MT-CO1, IL3RA, IRF8, TCF4, GAS6, DERL3 
##     RHEX, CLIC3, LILRB4, CLEC4C, LRRC26, RNASE6, VIM, SMPD3, JUNB, SCT</code></pre>
</div>
<div id="run-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#run-clustering" class="anchor"></a>Run Clustering</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pbmc10k <span class="ot">&lt;-</span> <span class="fu">FindNeighbors</span>(pbmc10k, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pbmc10k <span class="ot">&lt;-</span> <span class="fu">FindClusters</span>(pbmc10k</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># resolution = 0.5</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                        )</span></code></pre></div>
<pre><code>## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck
## 
## Number of nodes: 2080
## Number of edges: 81514
## 
## Running Louvain algorithm...
## Maximum modularity in 10 random starts: 0.8168
## Number of communities: 10
## Elapsed time: 0 seconds</code></pre>
</div>
<div id="run-umap" class="section level3">
<h3 class="hasAnchor">
<a href="#run-umap" class="anchor"></a>Run UMAP</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pbmc10k <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(pbmc10k, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(pbmc10k, <span class="at">reduction =</span> <span class="st">"umap"</span>)</span></code></pre></div>
<p><img src="pbmc10k_tutorial_cosg_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div id="run-cosg" class="section level3">
<h3 class="hasAnchor">
<a href="#run-cosg" class="anchor"></a>Run COSG</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>marker_cosg<span class="ot">&lt;-</span><span class="fu">cosg</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  pbmc10k,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">groups=</span><span class="st">'all'</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">assay=</span><span class="st">'RNA'</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">slot=</span><span class="st">'data'</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu=</span><span class="dv">1</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_genes_user=</span><span class="dv">2000</span>)</span></code></pre></div>
</div>
<div id="check-the-marker-genes" class="section level3">
<h3 class="hasAnchor">
<a href="#check-the-marker-genes" class="anchor"></a>Check the marker genes</h3>
<p>Check markers:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(marker_cosg<span class="sc">$</span>names)</span></code></pre></div>
<pre><code>##         0          1      2      3        4         5          6         7
## 1    LEF1     GPR183   GNLY   FCN1    DUSP4      GZMK      TRGC2      IGHM
## 2    CCR7      TRADD  KLRF1   MNDA    CCR10   SLC4A10       CD8A     MS4A1
## 3    TCF7       PASK FCGR3A    LYZ    FANK1       LTK       CD8B     CD79A
## 4 TRABD2A      CRIP2 FGFBP2   CSTA C15orf53     CPNE7      CRTAM      IGHD
## 5    SELL AC139720.1  SPON2 S100A8     CCR4 LINC01644 AC020659.1 LINC00926
## 6   NOSIP      AP3M2   GZMB S100A9    FOXP3   TSPAN15      KLRG1    BCL11A
##           8      9
## 1 LINC02446  TUBB1
## 2      CD8B  CMTM5
## 3     CD8B2    PF4
## 4      DSEL   PPBP
## 5     FBLN2 TMEM40
## 6     S100B   CTTN</code></pre>
<p>Check scores:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(marker_cosg<span class="sc">$</span>scores)</span></code></pre></div>
<pre><code>##           0         1         2         3         4         5         6
## 1 0.5112298 0.1983444 0.9199549 0.9703298 0.4933155 0.3647031 0.4490881
## 2 0.5105121 0.1654157 0.9069867 0.9609553 0.4347762 0.3560721 0.4184702
## 3 0.4667756 0.1652340 0.8404576 0.9569131 0.3377563 0.3358231 0.2437492
## 4 0.4630908 0.1419786 0.8064928 0.9550107 0.3303547 0.2869962 0.2155549
## 5 0.4576883 0.1407042 0.8031722 0.9530925 0.2930473 0.2712109 0.1928761
## 6 0.4553455 0.1399450 0.7973119 0.9517717 0.2677429 0.2515382 0.1862127
##           7         8         9
## 1 0.8644972 0.5740887 0.9884659
## 2 0.8532755 0.2986541 0.9759355
## 3 0.8329061 0.2802284 0.9698318
## 4 0.7799647 0.2404015 0.9685507
## 5 0.7706480 0.2289249 0.9684973
## 6 0.7339749 0.1902490 0.9600918</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>top_list<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (group <span class="cf">in</span> <span class="fu">colnames</span>(marker_cosg<span class="sc">$</span>names)){</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    top_i<span class="ot">&lt;-</span>marker_cosg<span class="sc">$</span>names[group][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span>]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    top_list<span class="ot">&lt;-</span><span class="fu">c</span>(top_list,top_i)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DotPlot</span>(pbmc10k, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">assay =</span> <span class="st">'RNA'</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># scale=TRUE,</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span>  <span class="fu">unique</span>(top_list)) <span class="sc">+</span> <span class="fu">RotatedAxis</span>()</span></code></pre></div>
<p><img src="pbmc10k_tutorial_cosg_files/figure-html/unnamed-chunk-23-1.png" width="1536"></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DoHeatmap</span>(pbmc10k, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">assay =</span> <span class="st">'RNA'</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span>  top_list) </span></code></pre></div>
<p><img src="pbmc10k_tutorial_cosg_files/figure-html/unnamed-chunk-24-1.png" width="1920"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/genecell">Min Dai</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
